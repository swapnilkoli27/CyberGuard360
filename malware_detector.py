import os
import hashlib

# Example scan_directory function
def scan_directory(path):
    detected_files = []
    total_files = 0
    known_malicious_hashes = [
        '6357117ebcca0b9dfe1d7efae467af4c',  # Add your known malicious hashes here
        '1866f120ab11f4a1da2e56897e36123f',
        '4e2e670a5d1624ce1ea623d763a9df22',
        '6024b18ab5cf989d48559d8b0c0baba2',
        'c9466046cbb424f0d735dc89ce86f02e',
        'eb5faec7ef6523165811b62ed8dcbcf0',
        'a0dae4b3903aa425b2ef0a2d1d9fce92',
        'be70732751549a0b337a9608b728ce07',
        'ca97c3341170c8473178814311b0b897',
        '25aefed46377a3502076766ad1a9879f'
    ]

    for root, _, files in os.walk(path):
        for file in files:
            total_files += 1
            file_path = os.path.join(root, file)
            try:
                with open(file_path, 'rb') as f:
                    file_hash = hashlib.md5(f.read()).hexdigest()
                    if file_hash in known_malicious_hashes:
                        detected_files.append(file_path)
            except Exception as e:
                print(f"Error reading file {file_path}: {e}")

    return detected_files, total_files

# Function to start the scan
def start_malware_scan():
    path_to_scan = r"D:\abc"  # Example path for specific folder
    # You can also set path_to_scan = r"C:\" for scanning the entire drive.
    
    detected_files, total_files = scan_directory(path_to_scan)
    
    # Update your GUI with the results
    if detected_files:
        print(f"Threats detected: {len(detected_files)}")
        for detected in detected_files:
            print(f"Detected: {detected}")
    else:
        print("No threats detected.")

# Example usage
if __name__ == "__main__":
    start_malware_scan()
